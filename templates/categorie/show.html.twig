{% extends 'base.html.twig' %}

{% block title %}Category Topics{% endblock %}

{% block body %}   

    <div>
        <p><a href="{{ path('app_categorie') }}">back to category list</a></p>
    </div>
    <div>
        <h2>{{categorie}}</h2>
    </div>

    <div class="topics">
        <h3>Topics</h3>
        
        
        <table>
        {% for topic in categorie.topics %}
            <div class="categorie-topic">
                <tr>
                    {% if topic.auteur is empty %}
                        <td>
                            {{ 'deleted' }}
                            {{topic.dateCreation | date('d-m-Y H:i:s')}}
                        </td>
                    {% else %}
                        <td>
                            <a href="{{ path('show_personne', {'id': topic.auteur.id}) }}">{{topic.auteur}}</a>
                            {{topic.dateCreation | date('d-m-Y H:i:s')}}
                        </td>
                    {% endif %}
                    <td><a href="{{ path('show_topic', {'id': topic.id}) }}">{{topic}} </a></td>

                    
                    {#if user is topic auteur, can edit/delete topic#}
                    {% if app.user == topic.auteur %}
                        <td>
                            <a href="{{ path('edit_topic',  {'categorie_id': categorie.id, 'id': topic.id}) }}"><i class="fa-solid fa-pen-to-square fa-lg"></i></a>
                            <a href="{{ path('delete_topic', {'id': topic.id}) }}" onclick="return confirm('delete topic ?')"><i class="fa-solid fa-trash fa-lg"></i></a>
                        </td>
                    {% endif %}
                    
                </tr>
            </div>
        {% endfor %}
        </table>

        <p><a href="{{ path('new_topic', {'categorie_id': categorie.id}) }}">new topic</a></p>
    </div>
    

{% endblock %}